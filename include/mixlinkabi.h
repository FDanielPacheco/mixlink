/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Introduction
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

/**********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************//**
 * @file      mixlinkabi.h
 * 
 * @version   1.0
 *
 * @date      23-10-2025
 *
 * @brief     ABI header.
 *  
 * @author    Fábio D. Pacheco, 
 * @email     fabio.d.pacheco@inesctec.pt or pacheco.castro.fabio@gmail.com
 *
 * @copyright Copyright (c) [2025] [Fábio D. Pacheco]
 * 
 * @note      Manuals:
 * 
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Definition file
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#ifndef MIXLINKABI_H
#define MIXLINKABI_H 

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Imported libraries
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#include <stddef.h>
#include <stdint.h>
#include <stdbool.h>
#include <xcserial.h>

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * External C++ extern macro
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#ifdef __cplusplus  
extern "C" {        
#endif


/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * New types
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

typedef struct{
  uint8_t * val;                                                               //!< Values stored on the buffer, this requires initialization
  size_t len;                                                                  //!< The length of the data stored in `val` 
  size_t size;                                                                 //!< The total length of the memory region of `val`
} mixlink_buf8_t;

typedef struct{
  uint16_t * val;                                                              //!< Values stored on the buffer, this requires initialization
  size_t len;                                                                  //!< The length of the data stored in `val` 
  size_t size;                                                                 //!< The total length of the memory region of `val`
} mixlink_buf16_t;

typedef struct{
  uint32_t * val;                                                              //!< Values stored on the buffer, this requires initialization
  size_t len;                                                                  //!< The length of the data stored in `val` 
  size_t size;                                                                 //!< The total length of the memory region of `val`
} mixlink_buf32_t;

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * ABI data structures
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

//!< Generalistic ABI for IO dynamic functions
typedef struct{
  mixlink_buf8_t * data;
} mixlink_abi_default_io_t;

//!< Used for segmentation ABI for IO dynamic functions
typedef struct{
  mixlink_buf8_t * data;
  mixlink_buf16_t * index;
} mixlink_abi_segment_io_t;

//!< Used for every function associated with the driver
typedef struct {
  serial_t * sr;
} mixlink_abi_driver_def_t;

typedef struct {
  serial_t * sr;
  mixlink_buf8_t * data;
} mixlink_abi_driver_io_t;

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Sections Macros
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#define MIXLINK_STACK_SECTION_CONTROLLER         "mod_mixlink_controller"
#define MIXLINK_STACK_SECTION_CONTROLLER_QOS     "mod_mixlink_controller_qos"
#define MIXLINK_STACK_SECTION_CONTROLLER_SEGM    "mod_mixlink_controller_segm"
#define MIXLINK_STACK_SECTION_CONTROLLER_FRAMER  "mod_mixlink_controller_framer"
#define MIXLINK_STACK_SECTION_CONTROLLER_DRIVER  "mod_mixlink_controller_driver"

#define MIXLINK_STACK_SECTION_TRANSLATOR         "mod_mixlink_translator"
#define MIXLINK_STACK_SECTION_TRANSLATOR_OPT     "mod_mixlink_translator_opt"
#define MIXLINK_STACK_SECTION_TRANSLATOR_FRAMER  "mod_mixlink_translator_framer"

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * External C++ extern macro
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#ifdef __cplusplus  
}
#endif

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * Definition file
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/

#endif

/***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
 * End of file
 **************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
